### Hardening
 - The process of putting an operating system or application in a secure configuration is called hardening. 
 - When hardening a system, it is important to keep in mind its intended use, because hardening a system can also restrict the system's access and capabilities.

## Endpoint Protection

### AntiVirus (A-V)/Anti-Malware:
 - An "A-V" product will now perform generalized malware detection, meaning not just viruses and worms, but also Trojans, spyware, PUPs, cryptojackers, and so on. 

### Host-Based Intrusion Detection/Prevention (HIDS/HIPS)
 - Host-based intrusion detection systems (HIDS) provides threat detection via log and file system monitoring. 
 - HIDS comes in many different forms with different capabilities, some of them preventative (HIPS).
 - File system integrity monitoring uses signatures to detect whether a managed file image—such as an OS system file, driver, or application executable—has changed. 
 - Products may also monitor ports and network interfaces, and process data and logs generated by specific applications, such as HTTP or FTP.

### Endpoint Protection Platform (EPP):
 - An endpoint protection platform (EPP) is a single agent performing multiple security tasks, including malware/intrusion detection and prevention, but also other security features, such as a host firewall, web content filtering/secure search and browsing, and file/message encryption. 

### Data loss Prevention (DLP):
 - Many EPPs include a data loss prevention (DLP) agent. 
 - The agent enforces the policy to prevent data from being copied or attached to a message without authorization.

## Next-Gen Endpoint Protection

### Endpoint Detection and Response (EDR)
 - An endpoint detection and response (EDR) product's aim is not to prevent initial execution, but to provide real-time and historical visibility into the compromise, contain the malware within a single host, and facilitate remediation of the host to its original state. 

### Next-Generation Firewall Integration
 - An analytics-driven next-gen antivirus product is likely to combine with the perimeter and zonal security offered by next-gen firewalls.

# Endpoint Security
What is a hardened configuration?
 > A basic principle of security is to run only services that are needed. A hardened system is configured to perform a role as client or application server with the minimal possible attack surface, in terms of interfaces, ports, services, storage, system/registry permissions, lack of security controls, and vulnerabilities.

2.True or false? Only Microsoft's operating systems and applications require security patches.
 > False—any vendor's or open-source software or firmware can contain vulnerabilities that need patching.

3.Antivirus software has reported the presence of malware but cannot remove it automatically. Apart from the location of the affected file, what information will you need to remediate the system manually?
 > The string identifying the malware. You can use this to reference the malware on the A-V vendor's site and, hopefully, obtain manual removal and prevention advice.

4.You are consulting with a medium-size company about endpoint security solutions. What advantages does a cloud-based analytics platform have over an on-premises solution that relies on signature updates?
 > Advanced persistent threat (APT) malware can use many techniques to evade signature-based detection. A cloud analytics platform, backed by machine learning, can apply more effective behavioral-based monitoring and alerting.

5.If you suspect a process of being used for data exfiltration but the process is not identified as malware by A-V software, what types of analysis tools will be most useful?
 > You can use a sandbox with monitoring tools to see which files the process interacts with and a network monitor to see if it opens (or tries to open) a connection with a remote host.


## Hardware Root of Trust
 - A hardware Root of Trust (RoT) or trust anchor is a secure subsystem that is able to provide attestation.
 - The RoT is usually established by a type of cryptoprocessor called a trusted platform module (TPM).
   - PM is a specification for hardware-based storage of encryption keys, hashed passwords, and other user and platform identification information. 
   - The TPM is implemented either as part of the chipset or as an embedded function of the CPU.
   - Each TPM is hard-coded with a unique, unchangeable asymmetric private key called the endorsement key.
   - Anyone with administrative control over the setup program can take ownership of the TPM, which destroys and then regenerates its subkeys.

## Boot Integrity
 - Most PCs and smartphones implement the unified extensible firmware interface (UEFI). 
 - UEFI provides code that allows the host to boot to an OS. 
 - UEFI can enforce a number of boot integrity checks.

### Secure Boot
 - Secure boot is designed to prevent a computer from being hijacked by a malicious OS. 
 - UEFI is configured with digital certificates from valid OS vendors. 
 - The system firmware checks the operating system boot loader and kernel using the stored certificate to ensure that it has been digitally signed by the OS vendor.
 - Secured Boot requires UEFI but not a TPM

### Measured Boot
 - A trusted or measured boot process uses platform configuration registers (PCRs) in the TPM at each stage in the boot process to check whether hashes of key system state data (boot firmware, boot loader, OS kernel, and critical drivers) have changed. 
 - This does not usually prevent boot, but it will record the presence of unsigned kernel-level code.

### Boot Attestation
 - Boot attestation is the capability to transmit a boot log report signed by the TPM via a trusted process to a remote server, such as a network access control server. 
 - The boot log can be analyzed for signs of compromise, such as the presence of unsigned drivers. 
 - The host can be prevented from accessing the network if it does not meet the required health policy or if no attestation report is received.

### Trusted Boot
 - Just before Loading the driers, ELAM (Early Launch Anti-Malware) starts

## Disk Encryption

### Full disk encryption (FDE) 
 - means that the entire contents of the drive (or volume), including system files and folders, are encrypted. 
 - OS ACL-based security measures are quite simple to circumvent if an adversary can attach the drive to a different host OS. 
 - FDE requires the secure storage of the key used to encrypt the drive contents. Normally, this is stored in a TPM. 
 - The TPM chip has a secure storage area that a disk encryption program, such as Windows BitLocker.

### Self-Encrypting Drives (SED) 
 - where the cryptographic operations are performed by the drive controller.
 - The SED uses a symmetric data/media encryption key (DEK/MEK) for bulk encryption and stores the DEK securely by encrypting it with an asymmetric key pair called either the authentication key (AK) or key encryption key (KEK). 

### Early types of SEDs used proprietary mechanisms, but many vendors now develop to the Opal (Standards for implementing device encryption on storage devices.) Storage Specification developed by Trusted Computing Group (TCG)
